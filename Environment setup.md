# Настройка окружения для веб-разработки

## Установка пакетного менеджера для OS

### **Mac**: Homebrew

Нужна Mac OS X10 или новее, более ранние версии поддерживаются частично (но можно попробовать).

1. Открыть терминал. Если не знаете, [как это сделать](http://pk-help.com/apple/terminal-mac)
2. _В терминале_ ввести
   `xcode-select --install`
   `/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"`
   > Проверка, что Homebrew установился: `brew help`

[Установка Homebrew](https://it-here.ru/instruktsii/kak-ustanovit-homebrew-na-mac/)
Еще [статья](https://lifehacker.ru/homebrew/)

### **Windows**: Chocolatey

[Установка](https://chocolatey.org/install)

1. Запустить Powershell _от имени администратора_.
   В строке поиска Windows (там где значок лупы) ввести `Powershell`, в списке результатов находим Windows Powershell; запускаем через контекстное меню - запуск от имени администратора (пункт со значком щита).
2. Выполнить команду
   `Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))`
   > Проверить, что все установилось и работает:
   > `choco -h`
   > Если не работает, попробуйте перезагрузить терминал.

#### Предоставление разрешений chocolatey

Выполнить:
`choco feature enable -n allowGlobalConfirmation`
Это дает Chocolatey необходимые разрешения, чтобы он не запрашивал их каждый раз при установке программ.

## Установка Visual Studio Code

Если вы установили Chocolatey / Homebrew, вы можете установить VS Code через командную строку (наиболее быстрый и удобный способ).

### Windows

`choco install vscode`

После установки у вас должен появиться пункт `open in VSCode` в контекстном меню папки.
Если его нет (допустим, вы устанавливали VS Code вручную и не установили соответствующую опцию), придется переустановить VS Code. Или использовать скрипт, добавляющий соответствующий пункт в реестр Windows (выдаю по запросу).

Кроме этого, команда `code` теперь должна быть известна системе (быть в PATH) и быть доступной для использования в командной строке. Т.е. мы теперь можем открыть какой-либо файл из консоли, написав `code <путь к файлу>`. Проверка доступности команды: `code --version`, `code --help`.
Если не работает, попробуйте перезагрузить терминал.

### Mac

`brew cask install visual-studio-code`

#### Как добавить code в PATH

На MacOS команда `code` не устанавливается в PATH автоматически. Чтобы ее добавить, откройте в VS Code командную палитру (открывается через F1 или Ctrl+Shift+P), найдите команду
`Shell Command: Install 'code' command in PATH command` и выполните ее (т.е. просто на нее нажмите).
Перезапустите терминал.

Если эта команда отсутствует или не сработала: можно попробовать выполнить

```
cat << EOF >> ~/.bash_profile
# Add Visual Studio Code (code)
export PATH="\$PATH:/Applications/Visual Studio Code.app/Contents/Resources/app/bin"
EOF
```

более подробно см. [здесь](https://code.visualstudio.com/docs/setup/mac)

#### Как открыть папку в VS Code на Mac

При использовании VS Code (как и большинства других IDE) важно открывать не отдельные файлы, а именно всю папку проекта, с которой IDE работает, как с единым целым, иначе часть функций будет недоступна.
В Windows в контекстном меню папки появляется команда Open in VS Code.
Чтобы добавить аналогичную функцию в VS Code:

- 1й метод: разархивируйте папку Open.in.VS.Code.workflow.zip из этого репозитория (содержит папку Open in VS Code.workflow) в папку: "~/Library/Services". См. [здесь](https://github.com/microsoft/vscode/issues/1223)
- 2й метод посложнее, См.[здесь](https://www.hongkiat.com/blog/customize-mac-right-click-menu/)
- Или же вы можете открыть папку, перетянув ее (drag-and-drop) на значок VS Code в доке.

### Альтернативный способ установки - вручную (Win / Mac)

Если по каким-то причинам вы не можете использовать пакетный менеджер, можно скачать с оф. сайта дистрибутив и устанавливить вручную, но при этом убедитесь, что установлены птички напротив пунктов про добавление VSCode в контекстное меню (open in VSCode) и в PATH (делает возможным запуск VS Code из командной строки командой `code`)

## Настройка VS Code

### Как менять настройки

Настройки в VSCode можно задавать двумя способами:

- через графический интерфейс (внизу слева значок шестеренки (manage) - settings), чтобы быстро найти нужный пункт, используем поле поиска;
- через файл settings.json (для этого желательно быть знакомым с синтаксисом JSON-файлов). Открыть можно командой Preferences: Open settings(JSON). Так или иначе, все настройки сохраняются в settings.json.
  > настройки расширений можно увидеть, если на вкладке extensions в сайдбаре нажать на шестеренку у соответствующего расширения. Внизу будет пункт `Extension settings` (если настройки для данного расширения вообще предусмотрены).

### Некоторые настройки, которые желательно задать сразу

`"files.eol": "\n"` (задает "линуксовые" окончания строк).

### Встроенный терминал

Вы можете увидеть встроенный терминал в нижней панели, нажав `Ctrl + J`
(и перейти на вкладку terminal). При открытии проекта текущая директория терминала будет соответствовать папке проекта. Все настройки командной оболочки сохраняются, т.е. к примеру, если вы установили posh-git для Powershell и сделали powershell дефолтной командной оболочкой в VS Code, то posh-git будет работать у вас и в терминале VS Code.

> Чтобы перезагрузить терминал, обновите окно (перезагрузите) VS Code (команда Developer: Reload Window)

> Подсказка: в терминале VS Code можно переместить курсор сразу в нужное вам место с помощью Alt+Click

### Расширение Settings sync

Это расширение, которое позволяет синхронизировать настройки VS Code между компьютерами. Мы его используем, чтобы сразу установить целый набор полезных плагинов.

Но, в связи с тем, что загрузка настроек _перезаписывает_ локальный файл настроек, лучше всего это делать только сразу же после первой установки VS Code для задания начальных настроек. В дальнейшем ваши настройки будут меняться по вашему вкусу, поэтому начальные настройки содержат id другого Gist, который в свою очередь содержит только список расширений. Т.о. задействуем двухэтапную схему: студент подключается к первому gist - загружает настройки - и тем самым подключается вместо первого ко второму gist, с которым и работает дальше, в дальнейшем по команде `Sync: Download settings` будут загружаться актуальные расширения, прописанные преподавателем в предназначенном для этого gist.

Сначала нужно установить сам Settings Sync, вбив его название в поле поиска на вкладке "extensions" в сайдбаре и нажав install.

Затем откройте его настройки и:

- в поле `sync: Gist` введите id для синхронизации: `ab564ce11c3662da32a5fa360c312553`
- выполните команду из палитры: `Sync: Advanced options` - скачать настройки из публичного Gist. В левом нижнем углу появится информ.окно (...больше не будет требовать подтверждения через токен...)
- после этого чтобы загрузить настройки, выполняем из палитры команду `Sync: Download settings`. Обратите внимание, что это перезапишет файл settings.json!
- затем нужно выполнить `Sync: Download settings` повторно, при этом VS Code скачает и установит набор расширений, после чего предложит перезагрузить окно, чтобы применить изменения (соглашайтесь).

#### Установка powershell-core как дефолтной командной оболочки

Добавьте в settings.json:
**Windows**:
"terminal.integrated.shell.windows": "C:\\\Program Files\\\PowerShell\\\7\\\pwsh.exe"

**Mac**:
"terminal.integrated.shell.osx": "/usr/local/bin/powershell"

## Установка Git

### **Windows**

1. Если вы установили chocolatey, вы можете установить Git for Windows одной командой из консоли:
   `choco install git`
   Дождитесь окончания установки.
   При необходимости (если в командной строке появится запрос на подтверждение) нажмите A, чтобы подтвердить. Такое может быть, если вы забыли выполнить [этот пункт](#Предоставление-разрешений-chocolatey)

> Проверка, что git установлен и работает: `git --version`. Или помощь по гиту: `git help`. Если не работает, попробуйте перезагрузить терминал.

### **MacOS**

Git уже установлен на вашей системе по умолчанию.

## Базовая настройка Git

Если вы уже меняли настройки: проверьте их.
Открыть непосредственно сам файл с настройками и посмотреть
`code $HOME\.gitconfig` (чтобы это сработало, code должен быть в PATH, см. про это)

Вывести список глобальных настроек Git можно также с помощью команды `git config --global --list` (выведет список настроек, чтобы вернуться в терминал, нажимаем клавишу q).
Убедитесь, что

- core.autocrlf=false
- задан user.email и user.name

Иначе: выполняем
`git config --global user.name "Name Surname"`,
`git config --global user.email "myemail@gmail.com"`
(подставьте соответствующее имя и email)
`git config --global core.autocrlf false`
и проверяем снова.

## Установка powershell-core

Powershell-core (pwsh) - это современная кросс-платформенная версия powershell, которая устанавливается и работает на Windows, MAcOS, Unix и т.д.
на Windows она устанавливается **параллельно** с _уже предустановленным Powershell 5_. Т.е. это по сути две независимых командных оболочки, которые устанавливаются в разные папки. Хотя по функционалу они не сильно отличаются, Powershell-core по сути приходит на смену Powershell, поэтому есть смысл установить и использовать сразу его.

### **Windows**

Из Powershell с админскими правами (как его открыть, смотрим [здесь в пункте 1](#__Windows__:-Chocolatey)) выполнить команду:
`iex "& { $(irm https://aka.ms/install-powershell.ps1) } -UseMSI -quiet -AddExplorerContextMenu"`

<!-- 🕮 <cyberbiont> 9156c6f7-fda7-4288-9147-24d3b538a5fb.md -->

> Проверка, что все установилось: `pwsh -h` Проверка используемой версии powershell: `$host.version`.
> Если не работает, попробуйте перезагрузить терминал.
> В контекстном меню при ПКМ по папке у вас должна появиться опция Powershell, которая позволяет быстро открыть его в данной папке.

### **Mac**

[Установка powershell-core на MacOS](https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell-core-on-macos?view=powershell-7)

1. Если вы до этого установили Homebrew: в терминале
   `brew cask install powershell`

> Проверка, что все установилось: `pwsh -h` Проверка используемой версии powershell: `$host.version`. Если не работает, попробуйте перезагрузить терминал.

#### Как открыть командную строку в конкретной папке из проводника?

- Можно использовать команду cd <путь к папке> (вместо < > копируем из проводника и вставляем абсолютный путь к папке)
  > если вы копируете путь из строки-приглашения Powershell, убедитесь, что не захватили случайно при копировании символ "\>" - он не должен входить в путь к папке.
- Еще один способ описан [здесь](https://appleinsider.ru/tips-tricks/mac-os-x-otkryvaem-terminal-v-vybrannoj-papke.html)
- или же, вы можете открыть папку в VSCode (см. про пункт контекстного меню `open in VS Code`) и использовать встроенный в VS Code терминал. Т.к. по умолчанию на Mac используется bash или zsh в зависимости от версии OS, вы можете изменить дефолтный терминал в VSCode на powershell см. [здесь](#установка-powershell-core-как-дефолтной-командной-оболочки):

## Установка posh-git

posh-git - это дополнение для Powershell, которое обеспечивает наглядную и комфортную работу с Git из командной строки. Для установки дополнения должен быть уже установлен сам Powershell (как это сделать, см. выше). Открываем его и выполняем команды (копируем и вставляем по одной):

1. (только для Windows) `Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Confirm`
2. `PowerShellGet\Install-Module posh-git -Scope CurrentUser -Force`
3. `Import-Module posh-git`
4. `Add-PoshGitToProfile`

Последняя команда добавляет posh-git в ваш профиль powershell (файл с настройками, т.о он будет автоматически подгружаться при запуске powershell.

> Проверка: posh-git отображает информацию о статусе git-репозитория и обеспечивает автодополнение для команд Git.
> введите в командной строке `git a` и нажмите Tab - команда будет расширена до `git add`. Повторные нажатия Tab позволяют переключаться между командами.

### Что показывает статус Posh-git

Если вы находитесь в папке, которая является гит-репозиторием, в командной строке отобразится статус, например, [master]. Количество внесенных по сравнению с предыдущим коммитом изменений (добавленные файлы/измененные/удаленные) отображается с помощью цифр красного цвета; если вы добавляете изменения в индекс(стейджинг-зону) с помощью команды git add, цвет сменяется на зеленый и это значит, что вы можете коммитить эти изменения при помощи команды `git commit`.

Подробно почитать об этом можно [здесь](https://github.com/dahlbyk/posh-git)

> Если вы внесли изменения в проект, то, чтобы статус posh-git обновился с учетом новых изменений, просто нажмите Enter в консоли (мы не выполняем никаких команд, но статус обновляется).

### Firefox Developer Edition

Инструмент Developer Tools в Firefox предоставляет некоторые возможности, которых нет в Chrome Developer Tools, в частности он очень удобен для работы с Flex и Grid, поэтому Firefox Developer Edition (версия, предзначенная специально для разработчиков) рекомендуется к установке дополнительно к Chrome. Быстрая установка через Chocolatey:
`choco install firefox-dev --pre`

## Дополнительно

### ConEmu (Windows) - (не обязательно)

ConEmu это эмулятор консоли, т.е. программа, которая предоставляет более удобную графическую оболочку для работы с командной строкой.

1. Архив conemu.zip в этом репозитории содержит портативную версию ConEmu, т.е. не требующую установки. Вы можете скачать архив, распаковать его в любую папку на компьютере и добавить на рабочий стол ярлык на файл ConEmu\App\ConEmu\СonEmu.exe
2. Если ConEmu уже установлен, скачайте просто файл conemu_settings.xml из репозитория и импортируйте его в ваш ConEmu через settings - Import (кнопка внизу).
3. Затем нужно будет на вкладке Settings - Integration нажать на кнопку Register (верхнюю). Это зарегистрирует пункт контекстного меню "ConEmu here" - вы сможете открывать Powershell+ConEmu в нужной вам папке из Windows Explorer.

### Windows: отключение UAC (надоедливого окна, которое вылезает и запрашивает разрешение что-то сделать)

через _Powershell_:
`New-ItemProperty -Path HKLM:Software\Microsoft\Windows\CurrentVersion\policies\system -Name EnableLUA -PropertyType DWord -Value 0 -Force`

_или_

Пуск - Панель-управления - Учетные записи пользователей - Изменить параметры контроля учетных записей.- Никогда не уведомлять (переместить ползунок вниз)

### Windows: включение отображения расширений файлов в проводнике

В проводнике Windows переключитесь на папку Вид - кнопка Параметры (справа) - изменить параметры папок и поиска - вкладка Вид - дополнительный параметры - скрывать расширения для зарегистрированных типов файлов (снять галку)
